<!DOCTYPE html>
<html  xmlns:th="http://www.thymeleaf.org">
<head>
<meta charset="utf-8">
<title>海报生成器</title>
<meta name="renderer" content="webkit">
<meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
<meta name="viewport"
	content="width=device-width, initial-scale=1, maximum-scale=1">
<link rel="stylesheet"
	href="https://www.layuicdn.com/layui/css/layui.css"
	media="all">
</head>
<body>

	<fieldset class="layui-elem-field layui-field-title"
		style="margin-top: 20px;">
		<legend>海报生成器</legend>
	</fieldset>

	<div style="padding: 20px; background-color: #F2F2F2;">
		<div class="layui-row layui-col-space15">
					<div class="layui-col-md12">
						<div class="layui-card">
							<div class="layui-card-header">ienglish听读地址</div>
							<div class="layui-card-body">
								<input type="text" id="address" required
									lay-verify="required" value="https://dictjson.tope365.com/ipeiyin/oral/327307/2337/201910102253_share.html?studentID=327307" autocomplete="off"
									class="layui-input">
							</div>
							
							<div class="layui-card-header">图片序号</div>
							<div class="layui-card-body">
								<input type="text" id="picindex" required
									lay-verify="required" value="1" autocomplete="off"
									class="layui-input">
							</div>
						
							<div class="layui-card-header">标题大小位置（35,100,300）</div>
							<div class="layui-card-body">
								<input type="text" id="titlepos" required
									lay-verify="required" value="35,100,300" autocomplete="off"
									class="layui-input">
							</div>
								
							
						</div>
								
						<div class="layui-card">
							<button class="layui-btn layui-btn-fluid" onclick="generate();">生成海报</button>
						</div>
					</div>
	
			<div class="layui-col-md12">
				<div class="layui-card">
					<div class="layui-card-header">海报模版</div>
					<div class="layui-card-body">
						<img id="templateImg" src="/images/poster/template.png" width=100% />
					</div>
				</div>
			</div>
		</div>
	</div>

		<script src="https://www.layuicdn.com/layui/layui.js"
			charset="utf-8"></script>
		<!-- 注意：如果你直接复制所有代码到本地，上述js路径需要改成你本地的 -->
		<script>
			layui.use([ 'jquery', 'layer' ], function() {
				var $ = layui.$;
				var layer = layui.layer;
				console.log($("#address").val());

			});
			
			function generate(){
				
				let add = layui.$("#address").val();
				console.log(add);
				let data = "address="+ add;
				let picindex = layui.$("#picindex").val();
				let titlepos = layui.$("#titlepos").val();
				/*
				layui.$.post("/poster/gen",{data:add},function(result){
					  console.log(result);
				  },"json");
				*/
				layui.$.ajax({
					  url:"/poster/gen",
					  type:"POST",
					  data: JSON.stringify({address:add,picindex:picindex,titlepos:titlepos}),
					  contentType:"application/json; charset=utf-8",
					  dataType:"json",
					  success: function(result){
						  console.log("ret code:"+result.code);
						  layui.$("#templateImg").attr("src",result.url);
					  },
					  error : function() {
					        alert('poster 失败 ');
					   }
					})
				
			}
			

		</script>
</body>
</html>